CREATE SCHEMA IF NOT EXISTS `sweets`;
USE `sweets` ;
CREATE TABLE IF NOT EXISTS `role` ( `id` INT NOT NULL AUTO_INCREMENT, `name` VARCHAR(45) NOT NULL, PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `user` ( `id` INT NOT NULL AUTO_INCREMENT, `username` VARCHAR(45) NOT NULL, `password` VARCHAR(45) NOT NULL, `fio` VARCHAR(45) NOT NULL, `role_id` INT NOT NULL, `hidden` INT NOT NULL DEFAULT 0, PRIMARY KEY (`id`), INDEX `fk_user_role_idx` (`role_id` ASC) VISIBLE, CONSTRAINT `fk_user_role` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `sweet` ( `id` INT NOT NULL AUTO_INCREMENT, `name` VARCHAR(45) NOT NULL, `price` FLOAT NOT NULL, `hidden` INT NOT NULL DEFAULT 0, PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `supplier` ( `id` INT NOT NULL AUTO_INCREMENT, `name` VARCHAR(45) NOT NULL, `address` VARCHAR(45) NOT NULL, `phone` VARCHAR(45) NOT NULL, `hidden` INT NOT NULL DEFAULT 0, PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `component` ( `id` INT NOT NULL AUTO_INCREMENT, `name` VARCHAR(45) NOT NULL, `amount` FLOAT NOT NULL, `supplier_id` INT NOT NULL, `hidden` INT NOT NULL DEFAULT 0, PRIMARY KEY (`id`), INDEX `fk_component_supplier1_idx` (`supplier_id` ASC) VISIBLE, CONSTRAINT `fk_component_supplier1` FOREIGN KEY (`supplier_id`) REFERENCES `supplier` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `sweet_has_component` ( `sweet_id` INT NOT NULL, `component_id` INT NOT NULL, `amount` FLOAT NOT NULL, PRIMARY KEY (`sweet_id`, `component_id`), INDEX `fk_sweet_has_component_component1_idx` (`component_id` ASC) VISIBLE, INDEX `fk_sweet_has_component_sweet1_idx` (`sweet_id` ASC) VISIBLE, CONSTRAINT `fk_sweet_has_component_sweet1` FOREIGN KEY (`sweet_id`) REFERENCES `sweet` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION, CONSTRAINT `fk_sweet_has_component_component1` FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `client` ( `id` INT NOT NULL AUTO_INCREMENT, `fio` VARCHAR(45) NOT NULL, `phone` VARCHAR(45) NOT NULL, `hidden` INT NOT NULL DEFAULT 0, PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `order` ( `id` INT NOT NULL AUTO_INCREMENT, `date` DATETIME NOT NULL, `client_id` INT NOT NULL, `user_id` INT NOT NULL, PRIMARY KEY (`id`), INDEX `fk_order_client1_idx` (`client_id` ASC) VISIBLE, INDEX `fk_order_user1_idx` (`user_id` ASC) VISIBLE, CONSTRAINT `fk_order_client1` FOREIGN KEY (`client_id`) REFERENCES `client` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION, CONSTRAINT `fk_order_user1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `order_has_sweet` ( `order_id` INT NOT NULL, `sweet_id` INT NOT NULL, `amount` FLOAT NOT NULL, PRIMARY KEY (`order_id`, `sweet_id`), INDEX `fk_order_has_sweet_sweet1_idx` (`sweet_id` ASC) VISIBLE, INDEX `fk_order_has_sweet_order1_idx` (`order_id` ASC) VISIBLE, CONSTRAINT `fk_order_has_sweet_order1` FOREIGN KEY (`order_id`) REFERENCES `order` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION, CONSTRAINT `fk_order_has_sweet_sweet1` FOREIGN KEY (`sweet_id`) REFERENCES `sweet` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
INSERT INTO `role` VALUES (1,'Работник'),(2,'Администратор');
INSERT INTO `user` VALUES (1,'root','63a9f0ea7bb98050796b649e85481845','root',2,0);